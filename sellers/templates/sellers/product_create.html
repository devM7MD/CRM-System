{% extends 'seller_base.html' %}
{% load static %}

{% block title %}Create New Product{% endblock %}

{% block header %}Create New Product{% endblock %}

{% block extra_css %}
<style>
    .form-section {
        background-color: white;
        border-radius: 0.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        margin-bottom: 1.5rem;
        overflow: hidden;
    }
    
    .form-section-header {
        background-color: #fef3c7;
        padding: 1rem 1.5rem;
        border-bottom: 1px solid #f59e0b;
    }
    
    .form-section-body {
        padding: 1.5rem;
    }
    
    .form-control {
        display: block;
        width: 100%;
        padding: 0.5rem 0.75rem;
        font-size: 0.875rem;
        line-height: 1.25rem;
        color: #1f2937;
        background-color: #ffffff;
        background-clip: padding-box;
        border: 1px solid #d1d5db;
        appearance: none;
        border-radius: 0.375rem;
        transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    }
    
    .form-control:focus {
        border-color: #f59e0b;
        outline: 0;
        box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.25);
    }
    
    .btn-primary {
        color: #ffffff;
        background-color: #f59e0b;
        border-color: #f59e0b;
        font-weight: 500;
        padding: 0.5rem 1rem;
        border-radius: 0.375rem;
        transition: all 0.2s ease-in-out;
    }
    
    .btn-primary:hover {
        background-color: #d97706;
        border-color: #b45309;
    }
    
    .btn-secondary {
        color: #4b5563;
        background-color: #ffffff;
        border: 1px solid #d1d5db;
        font-weight: 500;
        padding: 0.5rem 1rem;
        border-radius: 0.375rem;
        transition: all 0.2s ease-in-out;
    }
    
    .btn-secondary:hover {
        background-color: #f3f4f6;
    }
    
    .file-upload {
        position: relative;
        display: inline-block;
        width: 100%;
    }
    
    .file-upload-input {
        position: absolute;
        left: -9999px;
    }
    
    .file-upload-label {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0.75rem 1rem;
        background-color: #f9fafb;
        border: 1px dashed #d1d5db;
        border-radius: 0.375rem;
        cursor: pointer;
        transition: all 0.2s ease-in-out;
    }
    
    .file-upload-label:hover {
        background-color: #f3f4f6;
        border-color: #9ca3af;
    }
</style>
{% endblock %}

{% block content %}
<div class="bg-gray-50 min-h-screen">
    <div class="max-w-5xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
        <form method="post" enctype="multipart/form-data" class="space-y-6">
            {% csrf_token %}
            
            <!-- Basic Information -->
            <div class="form-section">
                <div class="form-section-header">
                    <h3 class="text-lg font-medium text-gray-900">Basic Information</h3>
                </div>
                <div class="form-section-body">
                    <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
                        <div>
                            <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Product Name (English)</label>
                            <input type="text" name="name" id="name" class="form-control" required>
                        </div>
                        
                        <div>
                            <label for="name_ar" class="block text-sm font-medium text-gray-700 mb-1">Product Name (Arabic)</label>
                            <input type="text" name="name_ar" id="name_ar" class="form-control">
                        </div>
                        
                        <div>
                            <label for="code" class="block text-sm font-medium text-gray-700 mb-1">SKU/Product Code</label>
                            <input type="text" name="code" id="code" class="form-control" required>
                        </div>
                        
                        <div>
                            <label for="category" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                            <input type="text" name="category" id="category" class="form-control" required>
                        </div>
                        
                        <div>
                            <label for="brand" class="block text-sm font-medium text-gray-700 mb-1">Brand</label>
                            <input type="text" name="brand" id="brand" class="form-control">
                        </div>
                        
                        <div>
                            <label for="product_link" class="block text-sm font-medium text-gray-700 mb-1">Product Link (Optional)</label>
                            <input type="url" name="product_link" id="product_link" class="form-control">
                        </div>
                        
                        <div class="md:col-span-2">
                            <label for="description" class="block text-sm font-medium text-gray-700 mb-1">Description (English)</label>
                            <textarea id="description" name="description" rows="3" class="form-control"></textarea>
                            <p class="mt-1 text-sm text-gray-500">Brief description of the product features and benefits.</p>
                        </div>
                        
                        <div class="md:col-span-2">
                            <label for="description_ar" class="block text-sm font-medium text-gray-700 mb-1">Description (Arabic)</label>
                            <textarea id="description_ar" name="description_ar" rows="3" class="form-control"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Pricing Information -->
            <div class="form-section">
                <div class="form-section-header">
                    <h3 class="text-lg font-medium text-gray-900">Pricing Information</h3>
                </div>
                <div class="form-section-body">
                    <div class="grid grid-cols-1 gap-6 md:grid-cols-3">
                        <div>
                            <label for="cost_price" class="block text-sm font-medium text-gray-700 mb-1">Cost Price (AED)</label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">AED</span>
                                </div>
                                <input type="number" name="cost_price" id="cost_price" min="0" step="0.01" class="form-control pl-12" required>
                            </div>
                        </div>
                        
                        <div>
                            <label for="selling_price" class="block text-sm font-medium text-gray-700 mb-1">Selling Price (AED)</label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">AED</span>
                                </div>
                                <input type="number" name="selling_price" id="selling_price" min="0" step="0.01" class="form-control pl-12" required>
                            </div>
                        </div>
                        
                        <div>
                            <label for="discount" class="block text-sm font-medium text-gray-700 mb-1">Discount (%)</label>
                            <div class="relative">
                                <input type="number" name="discount" id="discount" min="0" max="100" step="0.1" class="form-control pr-8">
                                <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 sm:text-sm">%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Inventory Information -->
            <div class="form-section">
                <div class="form-section-header">
                    <h3 class="text-lg font-medium text-gray-900">Inventory Information</h3>
                </div>
                <div class="form-section-body">
                    <div class="grid grid-cols-1 gap-6 md:grid-cols-3">
                        <div>
                            <label for="total_quantity" class="block text-sm font-medium text-gray-700 mb-1">Total Quantity</label>
                            <input type="number" name="total_quantity" id="total_quantity" min="0" step="1" class="form-control" required>
                        </div>
                        
                        <div>
                            <label for="available_quantity" class="block text-sm font-medium text-gray-700 mb-1">Available Quantity</label>
                            <input type="number" name="available_quantity" id="available_quantity" min="0" step="1" class="form-control" required>
                        </div>
                        
                        <div>
                            <label for="low_stock_threshold" class="block text-sm font-medium text-gray-700 mb-1">Low Stock Threshold</label>
                            <input type="number" name="low_stock_threshold" id="low_stock_threshold" min="0" step="1" class="form-control">
                            <p class="mt-1 text-sm text-gray-500">Alert when stock falls below this number</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Product Images -->
            <div class="form-section">
                <div class="form-section-header">
                    <h3 class="text-lg font-medium text-gray-900">Product Images</h3>
                </div>
                <div class="form-section-body">
                    <div class="space-y-6">
                        <div>
                            <label for="image" class="block text-sm font-medium text-gray-700 mb-2">Main Product Image</label>
                            <div class="file-upload">
                                <input type="file" name="image" id="image" class="file-upload-input" accept="image/*">
                                <label for="image" class="file-upload-label">
                                    <svg class="h-6 w-6 text-gray-400 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                    </svg>
                                    <span>Choose a file or drag and drop</span>
                                </label>
                            </div>
                            <p class="mt-1 text-sm text-gray-500">PNG, JPG, GIF up to 5MB</p>
                            <div id="image-preview" class="mt-2 hidden">
                                <div class="relative">
                                    <img src="#" alt="Image preview" class="h-24 w-24 object-cover rounded-md">
                                    <button type="button" id="remove-image" class="absolute -top-2 -right-2 bg-white rounded-full p-1 shadow">
                                        <svg class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-end space-x-3">
                <a href="{% url 'sellers:products' %}" class="btn-secondary">
                    Cancel
                </a>
                <button type="submit" class="btn-primary">
                    Create Product
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Set the available quantity to match total quantity by default
    document.getElementById('total_quantity').addEventListener('input', function() {
        document.getElementById('available_quantity').value = this.value;
    });

    // Calculate selling price based on cost price and markup
    document.getElementById('cost_price').addEventListener('input', function() {
        const costPrice = parseFloat(this.value) || 0;
        const markup = 0.3; // 30% markup by default
        const sellingPrice = costPrice * (1 + markup);
        document.getElementById('selling_price').value = sellingPrice.toFixed(2);
    });
    
    // Image preview functionality
    document.getElementById('image').addEventListener('change', function(e) {
        const file = this.files[0];
        if (file) {
            const reader = new FileReader();
            const preview = document.getElementById('image-preview');
            const img = preview.querySelector('img');
            
            reader.onload = function(e) {
                img.src = e.target.result;
                preview.classList.remove('hidden');
            }
            
            reader.readAsDataURL(file);
        }
    });
    
    // Remove image preview
    document.getElementById('remove-image').addEventListener('click', function() {
        document.getElementById('image').value = '';
        document.getElementById('image-preview').classList.add('hidden');
    });
</script>
{% endblock %} 