{% extends 'seller_base.html' %}
{% load i18n %}
{% load static %}

{% block title %}{% if request_id %}{% trans "Edit Sourcing Request" %}{% else %}{% trans "New Sourcing Request" %}{% endif %}{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="bg-gradient-to-r from-yellow-400 to-yellow-500 w-full px-6 py-6 flex justify-between items-center mb-6 rounded-lg shadow-md">
    <div>
        <h1 class="text-2xl font-bold text-gray-900">
            {% if request_id %}
                {% trans "Edit Sourcing Request" %}
            {% else %}
                {% trans "New Sourcing Request" %}
            {% endif %}
        </h1>
        <p class="text-sm text-gray-800 mt-1">
            {% trans "Submit your product sourcing request to our procurement team." %}
        </p>
    </div>
    <div>
        <a href="{% url 'sellers:sourcing_requests' %}" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-gray-900 bg-white hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 transition-all duration-200">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12" />
            </svg>
            {% trans "Back to Sourcing Requests" %}
        </a>
    </div>
</div>

<div class="bg-white shadow-md rounded-lg overflow-hidden border border-gray-200">
    <form method="post" id="sourcing-form" class="space-y-0" enctype="multipart/form-data">
        {% csrf_token %}
        
        <!-- Product Information Section -->
        <div class="px-6 py-5 border-b border-gray-200 bg-gray-50">
            <h3 class="text-lg font-medium text-gray-900">{% trans "Product Information" %}</h3>
        </div>

        <div class="p-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
            <!-- Product Name -->
            <div class="sm:col-span-4">
                <label for="product_name" class="block text-sm font-medium text-gray-700">
                    {% trans "Product Name" %} <span class="text-red-500">*</span>
                </label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="text" name="product_name" id="product_name" 
                           class="shadow-sm focus:ring-yellow-500 focus:border-yellow-500 block w-full sm:text-sm border-gray-300 rounded-md transition-colors duration-200"
                           placeholder="{% trans 'Enter product name (e.g., iPhone 15 Pro Max)' %}"
                           maxlength="255"
                           required
                           value="{{ sourcing_request.product_name|default:'' }}">
                </div>
                <p class="mt-1 text-sm text-gray-500">
                    {% trans "Provide clear, specific product name including model numbers if applicable" %}
                </p>
            </div>
            
            <!-- Carton Quantity -->
            <div class="sm:col-span-2">
                <label for="carton_quantity" class="block text-sm font-medium text-gray-700">
                    {% trans "Carton Quantity" %} <span class="text-red-500">*</span>
                </label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="number" name="carton_quantity" id="carton_quantity"
                           class="focus:ring-yellow-500 focus:border-yellow-500 block w-full pr-16 sm:text-sm border-gray-300 rounded-md transition-colors duration-200"
                           placeholder="0"
                           min="1" max="10000"
                           required
                           value="{{ sourcing_request.carton_quantity|default:'' }}">
                    <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">cartons</span>
                    </div>
                </div>
                <p class="mt-1 text-sm text-gray-500">
                    {% trans "Specify quantity in cartons/boxes. Standard carton sizes vary by product." %}
                </p>
            </div>
            
            <!-- Product Description -->
            <div class="sm:col-span-6">
                <label for="description" class="block text-sm font-medium text-gray-700">
                    {% trans "Product Description" %}
                </label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <textarea id="description" name="description" rows="4"
                              class="shadow-sm focus:ring-yellow-500 focus:border-yellow-500 block w-full sm:text-sm border-gray-300 rounded-md transition-colors duration-200"
                              maxlength="1000">{{ sourcing_request.notes|default:'' }}</textarea>
                </div>
                <div class="mt-1 flex justify-end">
                    <span id="char-count" class="text-sm text-gray-500">0/1000</span>
                </div>
            </div>
        </div>
        
        <!-- Sourcing Details Section -->
        <div class="px-6 py-5 border-t border-b border-gray-200 bg-gray-50">
            <h3 class="text-lg font-medium text-gray-900">{% trans "Sourcing Details" %}</h3>
        </div>
        
        <div class="p-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
            <!-- Source Country -->
            <div class="sm:col-span-3">
                <label for="source_country" class="block text-sm font-medium text-gray-700">
                    {% trans "Source Country (Country of Origin)" %} <span class="text-red-500">*</span>
                </label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9" />
                        </svg>
                    </div>
                    <select id="source_country" name="source_country"
                            class="pl-10 shadow-sm focus:ring-yellow-500 focus:border-yellow-500 block w-full sm:text-sm border-gray-300 rounded-md transition-colors duration-200"
                            required>
                        <option value="" {% if not sourcing_request.source_country %}selected{% endif %}>{% trans "Select country" %}</option>
                        <option value="China" {% if sourcing_request.source_country == 'China' %}selected{% endif %}>{% trans "China" %}</option>
                        <option value="India" {% if sourcing_request.source_country == 'India' %}selected{% endif %}>{% trans "India" %}</option>
                        <option value="Thailand" {% if sourcing_request.source_country == 'Thailand' %}selected{% endif %}>{% trans "Thailand" %}</option>
                        <option value="Vietnam" {% if sourcing_request.source_country == 'Vietnam' %}selected{% endif %}>{% trans "Vietnam" %}</option>
                        <option value="Malaysia" {% if sourcing_request.source_country == 'Malaysia' %}selected{% endif %}>{% trans "Malaysia" %}</option>
                        <option value="South Korea" {% if sourcing_request.source_country == 'South Korea' %}selected{% endif %}>{% trans "South Korea" %}</option>
                        <option value="Japan" {% if sourcing_request.source_country == 'Japan' %}selected{% endif %}>{% trans "Japan" %}</option>
                        <option value="Other" {% if sourcing_request.source_country == 'Other' %}selected{% endif %}>{% trans "Other" %}</option>
                    </select>
                </div>
                <p class="mt-1 text-sm text-gray-500">
                    {% trans "Select the country where you want the product to be sourced from" %}
                </p>
            </div>
            
            <!-- Destination Country -->
            <div class="sm:col-span-3">
                <label for="destination_country" class="block text-sm font-medium text-gray-700">
                    {% trans "Destination Country (Target Country)" %} <span class="text-red-500">*</span>
                </label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                    </div>
                    <select id="destination_country" name="destination_country"
                            class="pl-10 shadow-sm focus:ring-yellow-500 focus:border-yellow-500 block w-full sm:text-sm border-gray-300 rounded-md transition-colors duration-200"
                            required>
                        <option value="" {% if not sourcing_request.destination_country %}selected{% endif %}>{% trans "Select country" %}</option>
                        <option value="UAE" {% if sourcing_request.destination_country == 'UAE' %}selected{% endif %}>{% trans "United Arab Emirates (UAE)" %}</option>
                        <option value="Saudi Arabia" {% if sourcing_request.destination_country == 'Saudi Arabia' %}selected{% endif %}>{% trans "Saudi Arabia" %}</option>
                        <option value="Kuwait" {% if sourcing_request.destination_country == 'Kuwait' %}selected{% endif %}>{% trans "Kuwait" %}</option>
                        <option value="Qatar" {% if sourcing_request.destination_country == 'Qatar' %}selected{% endif %}>{% trans "Qatar" %}</option>
                        <option value="Bahrain" {% if sourcing_request.destination_country == 'Bahrain' %}selected{% endif %}>{% trans "Bahrain" %}</option>
                        <option value="Oman" {% if sourcing_request.destination_country == 'Oman' %}selected{% endif %}>{% trans "Oman" %}</option>
                        <option value="Egypt" {% if sourcing_request.destination_country == 'Egypt' %}selected{% endif %}>{% trans "Egypt" %}</option>
                        <option value="Jordan" {% if sourcing_request.destination_country == 'Jordan' %}selected{% endif %}>{% trans "Jordan" %}</option>
                        <option value="Other" {% if sourcing_request.destination_country == 'Other' %}selected{% endif %}>{% trans "Other" %}</option>
                    </select>
                </div>
                <p class="mt-1 text-sm text-gray-500">
                    {% trans "Select the country where the product should be delivered" %}
                </p>
            </div>
            
            <!-- Target Unit Price -->
            <div class="sm:col-span-2">
                <label for="target_price" class="block text-sm font-medium text-gray-700">
                    {% trans "Target Unit Price (Optional)" %}
                </label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <span class="text-gray-500 sm:text-sm">$</span>
                    </div>
                    <input type="number" name="target_price" id="target_price"
                           class="focus:ring-yellow-500 focus:border-yellow-500 block w-full pl-7 pr-16 sm:text-sm border-gray-300 rounded-md transition-colors duration-200"
                           placeholder="0.00"
                           step="0.01"
                           min="0"
                           value="{{ sourcing_request.cost_per_unit|default:'' }}">
                    <div class="absolute inset-y-0 right-0 flex items-center">
                        <select name="currency" class="h-full py-0 pl-2 pr-7 border-transparent bg-transparent text-gray-500 sm:text-sm rounded-md focus:ring-yellow-500 focus:border-yellow-500">
                            <option value="USD" {% if sourcing_request.currency == 'USD' %}selected{% endif %}>USD</option>
                            <option value="AED" {% if sourcing_request.currency == 'AED' %}selected{% endif %}>AED</option>
                            <option value="SAR" {% if sourcing_request.currency == 'SAR' %}selected{% endif %}>SAR</option>
                        </select>
                    </div>
                </div>
                <p class="mt-1 text-sm text-gray-500">
                    {% trans "Your expected price per unit" %}
                </p>
            </div>
            
            <!-- Funding Source -->
            <div class="sm:col-span-6">
                <label class="block text-sm font-medium text-gray-700">
                    {% trans "Funding Source" %} <span class="text-red-500">*</span>
                </label>
                <p class="text-sm text-gray-500 mb-2">
                    {% trans "Choose how this sourcing request will be financed" %}
                </p>
                <div class="mt-2 space-y-4 bg-gray-50 p-4 rounded-md border border-gray-200">
                    <div class="flex items-center p-2 rounded-md hover:bg-gray-100 transition-colors duration-150">
                        <input id="funding_seller" name="finance_source" type="radio" value="seller"
                               class="focus:ring-yellow-500 h-4 w-4 text-yellow-600 border-gray-300"
                               {% if sourcing_request.finance_source == 'seller' or not sourcing_request %}checked{% endif %}
                               required>
                        <label for="funding_seller" class="ml-3 block text-sm font-medium text-gray-700">
                            <span class="font-semibold">{% trans "Seller's Funds" %}</span> - {% trans "I will finance this sourcing request" %}
                        </label>
                    </div>
                    <div class="flex items-center p-2 rounded-md hover:bg-gray-100 transition-colors duration-150">
                        <input id="funding_crm" name="finance_source" type="radio" value="company"
                               class="focus:ring-yellow-500 h-4 w-4 text-yellow-600 border-gray-300"
                               {% if sourcing_request.finance_source == 'company' %}checked{% endif %}
                               required>
                        <label for="funding_crm" class="ml-3 block text-sm font-medium text-gray-700">
                            <span class="font-semibold">{% trans "CRM Funding Request" %}</span> - {% trans "Request CRM to finance this sourcing" %}
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- Quality Requirements -->
            <div class="sm:col-span-6">
                <label class="block text-sm font-medium text-gray-700">
                    {% trans "Quality Requirements" %}
                </label>
                <div class="mt-2 grid grid-cols-1 gap-y-2 sm:grid-cols-2 sm:gap-x-4 bg-gray-50 p-4 rounded-md border border-gray-200">
                    <div class="flex items-start p-2 rounded-md hover:bg-gray-100 transition-colors duration-150">
                        <div class="flex items-center h-5">
                            <input id="brand_new" name="brand_new" type="checkbox" 
                                   class="focus:ring-yellow-500 h-4 w-4 text-yellow-600 border-gray-300 rounded"
                                   {% if sourcing_request.brand_new %}checked{% endif %}>
                        </div>
                        <div class="ml-3 text-sm">
                            <label for="brand_new" class="font-medium text-gray-700">{% trans "Brand New Only" %}</label>
                        </div>
                    </div>
                    <div class="flex items-start p-2 rounded-md hover:bg-gray-100 transition-colors duration-150">
                        <div class="flex items-center h-5">
                            <input id="original_packaging" name="original_packaging" type="checkbox" 
                                   class="focus:ring-yellow-500 h-4 w-4 text-yellow-600 border-gray-300 rounded"
                                   {% if sourcing_request.original_packaging %}checked{% endif %}>
                        </div>
                        <div class="ml-3 text-sm">
                            <label for="original_packaging" class="font-medium text-gray-700">{% trans "Original Packaging Required" %}</label>
                        </div>
                    </div>
                    <div class="flex items-start p-2 rounded-md hover:bg-gray-100 transition-colors duration-150">
                        <div class="flex items-center h-5">
                            <input id="warranty_required" name="warranty_required" type="checkbox" 
                                   class="focus:ring-yellow-500 h-4 w-4 text-yellow-600 border-gray-300 rounded"
                                   {% if sourcing_request.warranty_required %}checked{% endif %}>
                        </div>
                        <div class="ml-3 text-sm">
                            <label for="warranty_required" class="font-medium text-gray-700">{% trans "Warranty Required" %}</label>
                        </div>
                    </div>
                    <div class="flex items-start p-2 rounded-md hover:bg-gray-100 transition-colors duration-150">
                        <div class="flex items-center h-5">
                            <input id="certified_products" name="certified_products" type="checkbox" 
                                   class="focus:ring-yellow-500 h-4 w-4 text-yellow-600 border-gray-300 rounded"
                                   {% if sourcing_request.certified_products %}checked{% endif %}>
                        </div>
                        <div class="ml-3 text-sm">
                            <label for="certified_products" class="font-medium text-gray-700">{% trans "Certified Products Only" %}</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Supplier Information (Optional) -->
        <div class="px-6 py-5 border-t border-b border-gray-200 bg-gray-50">
            <h3 class="text-lg font-medium text-gray-900">{% trans "Supplier Information (Optional)" %}</h3>
        </div>
        
        <div class="p-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
            <!-- Supplier Name -->
            <div class="sm:col-span-3">
                <label for="supplier_name" class="block text-sm font-medium text-gray-700">
                    {% trans "Supplier Name" %}
                </label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                        </svg>
                    </div>
                    <input type="text" name="supplier_name" id="supplier_name" 
                           class="pl-10 shadow-sm focus:ring-yellow-500 focus:border-yellow-500 block w-full sm:text-sm border-gray-300 rounded-md transition-colors duration-200"
                           value="{{ sourcing_request.supplier_contact|default:'' }}">
                </div>
                <p class="mt-1 text-sm text-gray-500">
                    {% trans "If you have a preferred supplier, provide their company name" %}
                </p>
            </div>
            
            <!-- Supplier Phone -->
            <div class="sm:col-span-3">
                <label for="supplier_phone" class="block text-sm font-medium text-gray-700">
                    {% trans "Supplier Phone Number" %}
                </label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                        </svg>
                    </div>
                    <input type="tel" name="supplier_phone" id="supplier_phone" 
                           class="pl-10 shadow-sm focus:ring-yellow-500 focus:border-yellow-500 block w-full sm:text-sm border-gray-300 rounded-md transition-colors duration-200"
                           placeholder="+1 (555) 123-4567"
                           value="{{ sourcing_request.supplier_phone|default:'' }}">
                </div>
                <p class="mt-1 text-sm text-gray-500">
                    {% trans "Include country code for international numbers" %}
                </p>
            </div>
            
            <!-- Special Instructions -->
            <div class="sm:col-span-6">
                <label for="special_instructions" class="block text-sm font-medium text-gray-700">
                    {% trans "Special Instructions/Notes" %}
                </label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <textarea id="special_instructions" name="special_instructions" rows="3"
                              class="shadow-sm focus:ring-yellow-500 focus:border-yellow-500 block w-full sm:text-sm border-gray-300 rounded-md transition-colors duration-200"
                              maxlength="500"></textarea>
                </div>
                <div class="mt-1 flex justify-end">
                    <span id="special-char-count" class="text-sm text-gray-500">0/500</span>
                </div>
            </div>
        </div>
        
        <!-- Form Actions -->
        <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3">
            {% if sourcing_request.id %}
                <button type="button" id="delete-btn" class="inline-flex items-center justify-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-all duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                    </svg>
                    {% trans "Delete" %}
                </button>
                
                <button type="submit" name="save_draft" value="1" class="inline-flex items-center justify-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
                    </svg>
                    {% trans "Save as Draft" %}
                </button>
            {% else %}
                <button type="submit" name="save_draft" value="1" class="inline-flex items-center justify-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all duration-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
                    </svg>
                    {% trans "Save as Draft" %}
                </button>
            {% endif %}
            
            <button type="submit" id="submit-btn" class="inline-flex items-center justify-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-yellow-600 hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 transition-all duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                {% if sourcing_request.status == 'draft' or not sourcing_request %}
                    {% trans "Submit Request" %}
                {% else %}
                    {% trans "Update Request" %}
                {% endif %}
            </button>
        </div>
    </form>
</div>

<!-- Delete Confirmation Modal -->
{% if sourcing_request.id %}
<div id="delete-modal" class="hidden fixed z-10 inset-0 overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
            <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                <div class="sm:flex sm:items-start">
                    <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10">
                        <svg class="h-6 w-6 text-red-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                        </svg>
                    </div>
                    <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                        <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">
                            {% trans "Delete Sourcing Request" %}
                        </h3>
                        <div class="mt-2">
                            <p class="text-sm text-gray-500">
                                {% trans "Are you sure you want to delete this sourcing request? This action cannot be undone." %}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                <form method="post" action="{% url 'sellers:sourcing_request_delete' sourcing_request.id %}">
                    {% csrf_token %}
                    <button type="submit" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm">
                        {% trans "Delete" %}
                    </button>
                </form>
                <button type="button" id="cancel-delete-btn" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                    {% trans "Cancel" %}
                </button>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add input animations
        const inputs = document.querySelectorAll('input[type="text"], input[type="number"], input[type="tel"], input[type="url"], textarea, select');
        inputs.forEach(input => {
            input.addEventListener('focus', function() {
                this.parentElement.classList.add('ring-2', 'ring-yellow-200', 'ring-opacity-50');
            });
            
            input.addEventListener('blur', function() {
                this.parentElement.classList.remove('ring-2', 'ring-yellow-200', 'ring-opacity-50');
            });
        });
        
        // Character counters
        const descriptionField = document.getElementById('description');
        const charCount = document.getElementById('char-count');
        
        const specialInstructionsField = document.getElementById('special_instructions');
        const specialCharCount = document.getElementById('special-char-count');
        
        function updateCharCount(field, counter, maxLength) {
            const currentLength = field.value.length;
            counter.textContent = `${currentLength}/${maxLength}`;
            
            if (currentLength > maxLength * 0.9) {
                counter.classList.add('text-yellow-600');
            } else {
                counter.classList.remove('text-yellow-600');
            }
            
            if (currentLength >= maxLength) {
                counter.classList.add('text-red-600');
            } else {
                counter.classList.remove('text-red-600');
            }
        }
        
        if (descriptionField && charCount) {
            updateCharCount(descriptionField, charCount, 1000);
            descriptionField.addEventListener('input', function() {
                updateCharCount(descriptionField, charCount, 1000);
            });
        }
        
        if (specialInstructionsField && specialCharCount) {
            updateCharCount(specialInstructionsField, specialCharCount, 500);
            specialInstructionsField.addEventListener('input', function() {
                updateCharCount(specialInstructionsField, specialCharCount, 500);
            });
        }
        
        // Form validation
        const form = document.getElementById('sourcing-form');
        const submitBtn = document.getElementById('submit-btn');
        
        if (form && submitBtn) {
            submitBtn.addEventListener('click', function(e) {
                if (!form.checkValidity()) {
                    e.preventDefault();
                    
                    // Find the first invalid field
                    const invalidFields = form.querySelectorAll(':invalid');
                    if (invalidFields.length > 0) {
                        invalidFields[0].focus();
                        invalidFields[0].parentElement.classList.add('ring-2', 'ring-red-200', 'ring-opacity-50');
                        
                        // Show a message
                        alert('{% trans "Please fill in all required fields correctly before submitting." %}');
                    }
                }
            });
        }
        
        // Delete modal
        const deleteBtn = document.getElementById('delete-btn');
        const deleteModal = document.getElementById('delete-modal');
        const cancelDeleteBtn = document.getElementById('cancel-delete-btn');
        
        if (deleteBtn && deleteModal && cancelDeleteBtn) {
            deleteBtn.addEventListener('click', function() {
                deleteModal.classList.remove('hidden');
            });
            
            cancelDeleteBtn.addEventListener('click', function() {
                deleteModal.classList.add('hidden');
            });
            
            // Close modal when clicking outside
            deleteModal.addEventListener('click', function(e) {
                if (e.target === deleteModal) {
                    deleteModal.classList.add('hidden');
                }
            });
        }
    });
</script>
{% endblock %} 